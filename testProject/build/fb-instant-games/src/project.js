require=function r(c,i,o){function l(e,t){if(!i[e]){if(!c[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(g)return g(e,!0);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}var s=i[e]={exports:{}};c[e][0].call(s.exports,function(t){return l(c[e][1][t]||t)},s,s.exports,r,c,i,o)}return i[e].exports}for(var g="function"==typeof require&&require,t=0;t<o.length;t++)l(o[t]);return l}({FbInstantGames:[function(t,e,n){"use strict";cc._RF.push(e,"df65flxV5BIf7nZCQKp8RMQ","FbInstantGames"),cc.Class({extends:cc.Component,properties:{testText:cc.Label,shareUrl:String,tSprite:cc.Node},onLoad:function(){},start:function(){},shareGame:function(){var t=this;this.tSprite.active=!0,"undefined"!=typeof FBInstant&&(FBInstant.shareAsync({intent:"SHARE",image:this.getImgBase64(),text:"Great!",data:{myReplayData:"..."}}).then(function(){t.testText.string="共有完了",console.log("共有完了")}),this.tSprite.active=!1)},sendRequest:function(){"undefined"!=typeof FBInstant&&(this.tSprite.active=!0,FBInstant.shareAsync({intent:"CUSTOM",image:this.getImgBase64(),text:"",data:{myReplayData:"..."}}).then(function(){this.testText.string="Message was sent successfully",console.log("Message was sent successfully")}).catch(function(){this.testText.string="",console.log("failed!")}),this.tSprite.active=!1)},playMessage:function(){"undefined"!=typeof FBInstant&&(this.tSprite.active=!0,FBInstant.updateAsync({action:"CUSTOM",cta:"Play",image:this.getImgBase64(),text:{default:FBInstant.player.getName()+"just played. It's your turn!",localizations:{zh_Hans:"繁体字の中国語",zh_Hant:"簡体字の中国語",zh_HK:"香港の繁体字",zh_CN:"中国の簡体字",zh_TW:"台湾の繁体字",ja_JP:FBInstant.player.getName()+"さんが今プレイしました。あなたの番です！"}},template:"WORD_PLAYED",data:{myReplayData:"..."},strategy:"IMMEDIATE",notification:"NO_PUSH"}).then(function(){console.log("Message was sent successfully"),this.testText.string="Message was sent successfully"}).catch(function(){console.log("failed!"),this.testText.string="failed"}),this.tSprite.active=!1)},createShortCut:function(){"undefined"!=typeof FBInstant&&FBInstant.canCreateShortcutAsync().then(function(t){t&&FBInstant.createShortcutAsync().then(function(){this.testText.string="ショートカット作成"}).catch(function(){this.testText.string="ショートカット作成失敗"})})},PlayWithFriends:function(){"undefined"!=typeof FBInstant&&FBInstant.context.chooseAsync().then(function(t){this.testText.string="FBInstant.context.chooseAsync complete",console.log("FBInstant.context.chooseAsync complete"),console.log(t)})},getImgBase64:function(t,e){var n=cc.find("Canvas"),a=720,s=375;null!=t&&null!=e&&(a=t,s=e);var r=new cc.RenderTexture(a,s);r.begin(),n._sgNode.visit(),r.end();var c=document.createElement("canvas"),i=c.getContext("2d");if(c.width=a,c.height=s,cc._renderType===cc.game.RENDER_TYPE_CANVAS){var o=r.getSprite().getTexture().getHtmlElementObj();i.drawImage(o,a/2,s/2)}else if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){var l=gl.createFramebuffer();gl.bindFramebuffer(gl.FRAMEBUFFER,l);var g=r.getSprite().getTexture()._glID;gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,g,0);var u=new Uint8Array(a*s*4);gl.readPixels(0,0,a,s,gl.RGBA,gl.UNSIGNED_BYTE,u),gl.bindFramebuffer(gl.FRAMEBUFFER,null);for(var f=4*a,d=0;d<s;d++){var y=s-1-d,h=new Uint8ClampedArray(u.buffer,y*a*4,f),p=new ImageData(h,a,1);i.putImageData(p,0,d)}}return c.toDataURL("image/png")}}),cc._RF.pop()},{}],FbMatchGame:[function(t,e,n){"use strict";cc._RF.push(e,"5be29NDA9ZMD6Si2H+Tp5l4","FbMatchGame"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.myPlayerID=null,this.entryPointData=null,"undefined"!=typeof FBInstant&&(this.myPlayerID=FBInstant.player.getID(),console.log("this.myPlayerID ; "+this.myPlayerID),this.entryPointData=FBInstant.getEntryPointData(),console.log("this.entryPointData  : "+JSON.stringify(this.entryPointData)))},start:function(){},OnEnableTHREAD:function(){return"undefined"!=typeof FBInstant&&"THREAD"==FBInstant.context.getType()},PlayBattleFriendChoose:function(){if("undefined"!=typeof FBInstant){var e=this;console.log(FBInstant.context.getID()),FBInstant.context.chooseAsync().then(function(){console.log("FBInstant.context.chooseAsync complete"),console.log(FBInstant.context.getID()),e.BattleUpdateAsync()}).catch(function(t){console.log(t),t.code==SAME_CONTEXT&&e.BattleUpdateAsync()})}},BattleUpdateAsync:function(){"undefined"!=typeof FBInstant&&(console.log("BattleUpdateAsync"),FBInstant.updateAsync({action:"CUSTOM",cta:"Play",image:this.getImgBase64(),text:{default:FBInstant.player.getName()+"just played. It's your turn!",localizations:{en_US:"",pt_BR:"",id_ID:"",fr_CA:"",vi_VN:"",th_TH:"",tr_TR:"",de_DE:"",es_ES:"",ar_AE:"",ja_JP:FBInstant.player.getName()+"対戦をしましょう"}},template:"WORD_PLAYED",data:{battlePlayerId:this.myPlayerID,battleScore:"22"},strategy:"IMMEDIATE",notification:"NO_PUSH"}).then(function(){console.log("Message was sent successfully OK")}).catch(function(t){return console.error(t)}))},getImgBase64:function(){var t=cc.find("Canvas"),e=cc.winSize.width,n=cc.winSize.height,a=new cc.RenderTexture(e,n);a.begin(),t._sgNode.visit(),a.end();var s=document.createElement("canvas"),r=s.getContext("2d");if(s.width=e,s.height=n,cc._renderType===cc.game.RENDER_TYPE_CANVAS){var c=a.getSprite().getTexture().getHtmlElementObj();r.drawImage(c,0,0),console.log("renderType:canvas")}else if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){var i=gl.createFramebuffer();gl.bindFramebuffer(gl.FRAMEBUFFER,i);var o=a.getSprite().getTexture()._glID;gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,o,0);var l=new Uint8Array(e*n*4);gl.readPixels(0,0,e,n,gl.RGBA,gl.UNSIGNED_BYTE,l),gl.bindFramebuffer(gl.FRAMEBUFFER,null);for(var g=4*e,u=0;u<n;u++){var f=n-1-u,d=new Uint8ClampedArray(l.buffer,f*e*4,g),y=new ImageData(d,e,1);r.putImageData(y,0,u)}console.log("renderType:WebGL")}return s.toDataURL("image/png")}}),cc._RF.pop()},{}]},{},["FbInstantGames","FbMatchGame"]);